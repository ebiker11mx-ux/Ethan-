<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Empire Estate: Rich Man</title>
<style>
  :root{
    --bg:#0f1216;
    --panel:#161b22;
    --card:#1c2330;
    --accent:#4ba3ff;
    --accent2:#47e6a1;
    --gold:#ffd66b;
    --red:#ff6b6b;
    --text:#e7eef8;
    --muted:#9fb0c7;
    --border:#253042;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:linear-gradient(180deg,#0b1016,#0f1216 60%,#0a0d12);color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}
  header{
    position:sticky;top:0;z-index:5;background:linear-gradient(90deg,#132033,#192b45);
    border-bottom:1px solid var(--border);
  }
  .topbar{
    display:flex;align-items:center;justify-content:space-between;padding:10px 16px;
  }
  .brand{display:flex;align-items:center;gap:10px;font-weight:700;letter-spacing:.3px}
  .brand .logo{width:32px;height:32px;border-radius:8px;background:conic-gradient(from 120deg,#47e6a1,#4ba3ff,#ffd66b,#47e6a1);box-shadow:0 0 0 2px #18243a}
  .festive{
    display:flex;gap:8px;align-items:center;color:var(--gold);font-size:14px;
  }
  .festive .ornament{filter:drop-shadow(0 3px 6px rgba(255,214,107,.3))}
  .container{padding:16px;max-width:1100px;margin:0 auto}
  .nav-tabs{display:flex;gap:8px;flex-wrap:wrap}
  .tab{
    padding:8px 12px;border:1px solid var(--border);border-radius:10px;background:var(--panel);
    cursor:pointer;color:var(--muted);transition:.15s ease;user-select:none
  }
  .tab.active{color:var(--text);background:linear-gradient(180deg,#1b2432,#192233);border-color:#2b3a52}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;margin-top:12px}
  .col-12{grid-column:span 12}
  .col-6{grid-column:span 12}
  @media(min-width:760px){.col-6{grid-column:span 6}}
  .card{
    background:linear-gradient(180deg,#1b2230,#1a2231 60%,#192032);
    border:1px solid var(--border);border-radius:14px;padding:14px;box-shadow:0 8px 24px rgba(0,0,0,.25)
  }
  .card h3{margin:0 0 8px;font-size:16px;letter-spacing:.2px}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .value{font-size:22px;font-weight:800;letter-spacing:.3px}
  .sub{color:var(--muted);font-size:13px}
  .btn{
    padding:8px 12px;border-radius:10px;border:1px solid #29405e;background:#1a2a42;color:var(--text);
    cursor:pointer;transition:.15s ease;font-weight:600
  }
  .btn:hover{transform:translateY(-1px);border-color:#3d5f8e}
  .btn.primary{background:linear-gradient(180deg,#1e3a5c,#23476f);border-color:#2e537f}
  .btn.accent{background:linear-gradient(180deg,#174c3a,#17624a);border-color:#1f7a5b}
  .btn.gold{background:linear-gradient(180deg,#5a4b18,#6e581c);border-color:#8d6a1f}
  .kpi{display:flex;gap:16px;flex-wrap:wrap;margin-top:6px}
  .kpi .pill{background:#18233a;border:1px solid var(--border);border-radius:999px;padding:6px 10px;color:#cfe0ff;font-size:12px}
  .bar{
    width:100%;height:10px;border-radius:999px;background:#131922;border:1px solid var(--border);overflow:hidden
  }
  .bar>span{display:block;height:100%;border-radius:999px;background:linear-gradient(90deg,#4ba3ff,#47e6a1)}
  .list{display:flex;flex-direction:column;gap:10px;margin-top:8px}
  .item{
    display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:12px;background:#182237;border:1px solid var(--border)
  }
  .item .title{font-weight:700}
  .muted{color:var(--muted)}
  .divider{height:1px;background:var(--border);margin:10px 0}
  .footer-nav{
    position:sticky;bottom:0;background:linear-gradient(180deg,#0f1216,#0a0d12);
    border-top:1px solid var(--border);padding:8px 6px;z-index:5
  }
  .footer-nav .tabs{display:flex;justify-content:space-around;gap:6px}
  .navbtn{
    display:flex;flex-direction:column;align-items:center;gap:4px;color:var(--muted);padding:8px;border-radius:10px;cursor:pointer
  }
  .navbtn.active{color:var(--text);background:#151b27;border:1px solid var(--border)}
  .navbtn .icon{font-size:18px}
  .tag{display:inline-block;background:#172233;border:1px solid var(--border);padding:2px 8px;border-radius:999px;font-size:12px;color:#cfe0ff}
  .right{display:flex;align-items:center;gap:8px}
  .small{font-size:12px}
  .earn-area{
    display:flex;flex-direction:column;align-items:center;gap:12px;text-align:center;padding:16px;border-radius:12px;background:#172033;border:1px solid var(--border)
  }
  .clickpad{
    width:100%;min-height:140px;border-radius:14px;background:radial-gradient(120px 140px at 20% 20%,rgba(71,230,161,.25),transparent 60%),#111621;
    border:2px dashed #2a3a55;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:.12s ease
  }
  .clickpad:hover{filter:brightness(1.08)}
  .badge{background:#24334d;color:#cfe0ff;font-size:12px;padding:2px 7px;border-radius:999px;border:1px solid var(--border)}
  .note{font-size:12px;color:#cfe0ff;background:#132033;border:1px solid var(--border);border-radius:10px;padding:8px}
  .danger{color:#ffb3b3}
  .success{color:#b7ffd9}
</style>
</head>
<body>
<header>
  <div class="topbar">
    <div class="brand"><div class="logo"></div>Empire Estate: Rich Man</div>
    <div class="festive"><span class="ornament">ğŸ„</span><span>Holiday Bonus Active</span><span class="ornament">âœ¨</span></div>
  </div>
</header>

<div class="container">
  <!-- Section Tabs -->
  <div class="nav-tabs" id="sectionTabs">
    <div class="tab active" data-section="dashboard">Dashboard</div>
    <div class="tab" data-section="investing">Investing</div>
    <div class="tab" data-section="business">Business</div>
    <div class="tab" data-section="earnings">Earnings</div>
    <div class="tab" data-section="items">Items</div>
    <div class="tab" data-section="profile">Profile</div>
  </div>

  <!-- Dashboard -->
  <div class="grid" id="dashboard">
    <div class="col-12 card">
      <h3>Total fortune</h3>
      <div class="row">
        <div class="value" id="totalFortune">$0.00</div>
        <span class="tag" id="hourlyIncomeTag">+$0.00 / hour</span>
        <span class="tag" id="taxTag">Taxes: 0%</span>
      </div>
      <div class="kpi">
        <div class="pill">Balance: <span id="balanceKpi">$0.00</span></div>
        <div class="pill">Businesses: <span id="businessKpi">$0.00</span></div>
        <div class="pill">Stocks: <span id="stocksKpi">$0.00</span></div>
        <div class="pill">Real estate: <span id="estateKpi">$0.00</span></div>
        <div class="pill">Transport: <span id="transportKpi">$0.00</span></div>
        <div class="pill">Collections: <span id="collectionsKpi">$0.00</span></div>
        <div class="pill">Cryptoassets: <span id="cryptoKpi">$0.00</span></div>
        <div class="pill">Residence: <span id="residenceKpi">$0.00</span></div>
      </div>
      <div class="divider"></div>
      <div class="row"><span class="sub">Asset distribution</span><span class="badge">Live</span></div>
      <div class="bar"><span id="barBusinesses" style="width:15%"></span></div>
      <div class="bar" style="margin-top:6px"><span id="barInvesting" style="width:10%"></span></div>
      <div class="bar" style="margin-top:6px"><span id="barItems" style="width:5%"></span></div>
      <div class="note" style="margin-top:10px">Tip: Grow passive income through businesses while compounding investments. Taxes apply to passive income only.</div>
    </div>
    <div class="col-6 card">
      <h3>Taxes</h3>
      <div class="row">
        <div class="value" id="taxRateLabel">15%</div>
        <button class="btn" id="toggleTax">Toggle tax bracket</button>
      </div>
      <p class="sub">Your passive hourly income is reduced by your current tax bracket. Upgrades and mergers raise gross income.</p>
    </div>
    <div class="col-6 card">
      <h3>Holiday bonus</h3>
      <div class="row">
        <div class="value success" id="bonusLabel">+10% income</div>
        <button class="btn accent" id="toggleBonus">Toggle bonus</button>
      </div>
      <p class="sub">Limited-time bonus boosts all passive income sources. Try it with mergers for compounding effects.</p>
    </div>
  </div>

  <!-- Investing -->
  <div class="grid" id="investing" style="display:none">
    <div class="col-12 card">
      <div class="row"><h3>Investing</h3><span class="badge">Shares Â· Real Estate Â· Crypto</span></div>
      <div class="nav-tabs" id="investTabs">
        <div class="tab active" data-sub="shares">Shares</div>
        <div class="tab" data-sub="estate">Real Estate</div>
        <div class="tab" data-sub="crypto">Cryptocurrency</div>
      </div>
      <div id="sharesPanel" class="list">
        <div class="item">
          <div>
            <div class="title">AD&D</div>
            <div class="muted small">Dividend: 5.32% Â· Yield boosts hourly income</div>
          </div>
          <div class="right">
            <div class="muted small">Holding: <span id="adndHolding">$0.00</span></div>
            <button class="btn primary" data-buy-share="ADND">Buy $100k</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Index Fund (S&P)</div>
            <div class="muted small">Diversified growth</div>
          </div>
          <div class="right">
            <div class="muted small">Holding: <span id="spHolding">$0.00</span></div>
            <button class="btn primary" data-buy-share="SP">Buy $100k</button>
          </div>
        </div>
      </div>
      <div id="estatePanel" class="list" style="display:none">
        <div class="item">
          <div>
            <div class="title">City Apartment</div>
            <div class="muted small">Rental income +$2,500/hour</div>
          </div>
          <div class="right">
            <div class="muted small">Owned: <span id="aptCount">0</span></div>
            <button class="btn accent" data-buy-estate="apartment">Buy $1.2M</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Luxury Villa</div>
            <div class="muted small">Rental income +$25,000/hour</div>
          </div>
          <div class="right">
            <div class="muted small">Owned: <span id="villaCount">0</span></div>
            <button class="btn accent" data-buy-estate="villa">Buy $12M</button>
          </div>
        </div>
      </div>
      <div id="cryptoPanel" class="list" style="display:none">
        <div class="item">
          <div>
            <div class="title">BTC</div>
            <div class="muted small">Volatile Â· No dividends</div>
          </div>
          <div class="right">
            <div class="muted small">Holding: <span id="btcHolding">$0.00</span></div>
            <button class="btn" data-buy-crypto="BTC">Buy $25k</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">ETH</div>
            <div class="muted small">Volatile Â· No dividends</div>
          </div>
          <div class="right">
            <div class="muted small">Holding: <span id="ethHolding">$0.00</span></div>
            <button class="btn" data-buy-crypto="ETH">Buy $25k</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Business -->
  <div class="grid" id="business" style="display:none">
    <div class="col-12 card">
      <div class="row"><h3>Business</h3><span class="badge">Passive income engine</span></div>
      <div class="row">
        <div class="pill">Total income/hour: <span id="bizIncomeTag">$0.00</span></div>
        <button class="btn primary" id="startBiz">Start a business</button>
        <button class="btn gold" id="mergeBiz">Business merger</button>
      </div>
      <div class="list" id="bizList"></div>
      <div class="note">Start low-cost companies, then merge for permanent +15% income on all businesses.</div>
    </div>
  </div>

  <!-- Earnings -->
  <div class="grid" id="earnings" style="display:none">
    <div class="col-12 card">
      <h3>Earnings</h3>
      <div class="earn-area">
        <div class="value">Balance: <span id="earnBalance">$0.00</span></div>
        <div class="muted">Per click: <span id="perClick">$4,700.00</span></div>
        <div class="clickpad" id="clickPad"><div>Click anywhere in this area to earn money</div></div>
        <div class="row">
          <button class="btn accent" id="upgradeClick">Upgrade clicks (+10%)</button>
          <span class="badge">Cost: <span id="clickCost">$250,000.00</span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Items -->
  <div class="grid" id="items" style="display:none">
    <div class="col-12 card">
      <div class="row"><h3>Items</h3><span class="badge">Transport Â· Residence Â· Collections</span></div>
      <div class="list">
        <div class="item">
          <div>
            <div class="title">Garage ğŸš—</div>
            <div class="muted small">Boost click income +5% per upgrade</div>
          </div>
          <div class="right">
            <div class="muted small">Level: <span id="garageLvl">0</span></div>
            <button class="btn" data-upgrade="garage">Upgrade $1.5M</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Hangar âœˆï¸</div>
            <div class="muted small">Passive income +3% per upgrade</div>
          </div>
          <div class="right">
            <div class="muted small">Level: <span id="hangarLvl">0</span></div>
            <button class="btn" data-upgrade="hangar">Upgrade $2.0M</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Harbor ğŸ›¥ï¸</div>
            <div class="muted small">Passive income +2% per upgrade</div>
          </div>
          <div class="right">
            <div class="muted small">Level: <span id="harborLvl">0</span></div>
            <button class="btn" data-upgrade="harbor">Upgrade $1.0M</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Residence ğŸ›ï¸</div>
            <div class="muted small">Adds net worth only Â· Prestige</div>
          </div>
          <div class="right">
            <div class="muted small">Value: <span id="residenceVal">$262,400,000.00</span></div>
            <button class="btn" data-upgrade="residence">Renovate $10M</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Collections ğŸª™ ğŸ¨</div>
            <div class="muted small">Adds net worth Â· rare finds</div>
          </div>
          <div class="right">
            <div class="muted small">Value: <span id="collectionsVal">$24,000,000.00</span></div>
            <button class="btn" data-upgrade="collections">Acquire $5M</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Profile -->
  <div class="grid" id="profile" style="display:none">
    <div class="col-12 card">
      <div class="row"><h3>Profile</h3><span class="badge">Autosave enabled</span></div>
      <div class="list">
        <div class="item">
          <div>
            <div class="title">Stats</div>
            <div class="muted small">Playtime, clicks, businesses, investments</div>
          </div>
          <div class="right small">
            <div id="statsSummary" class="muted">â€”</div>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Settings</div>
            <div class="muted small">Reset, export, import</div>
          </div>
          <div class="right">
            <button class="btn danger" id="resetBtn">Reset game</button>
            <button class="btn" id="exportBtn">Export save</button>
            <button class="btn" id="importBtn">Import save</button>
          </div>
        </div>
        <div class="item">
          <div>
            <div class="title">Achievements</div>
            <div class="muted small">Milestones unlock badges</div>
          </div>
          <div class="right small">
            <span class="badge" id="ach1">First Million ğŸ’°</span>
            <span class="badge" id="ach2">Tycoon ğŸ†</span>
            <span class="badge" id="ach3">Empire ğŸ‘‘</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bottom Navigation -->
<div class="footer-nav">
  <div class="tabs" id="bottomTabs">
    <div class="navbtn active" data-section="dashboard"><div class="icon">ğŸ“Š</div><div>Dashboard</div></div>
    <div class="navbtn" data-section="investing"><div class="icon">ğŸ’¹</div><div>Investing</div></div>
    <div class="navbtn" data-section="business"><div class="icon">ğŸ¢</div><div>Business</div></div>
    <div class="navbtn" data-section="earnings"><div class="icon">âš¡</div><div>Earnings</div></div>
    <div class="navbtn" data-section="items"><div class="icon">ğŸ</div><div>Items</div></div>
    <div class="navbtn" data-section="profile"><div class="icon">ğŸ‘¤</div><div>Profile</div></div>
  </div>
</div>

<script>
/* ======= Game State ======= */
const DEFAULT_STATE = {
  balance: 2040451.91,
  perClick: 4700,
  clickUpCost: 250000,
  clickUps: 0,
  taxRate: 0.15,
  holidayBonus: 0.10,
  bonusActive: true,
  stats: { clicks: 0, playSeconds: 0, businessesStarted: 0, merges: 0, purchases: 0 },

  // Investing holdings
  investing: {
    shares: { ADND: 0, SP: 0 },
    estate: { apartment: 0, villa: 0 },
    crypto: { BTC: 0, ETH: 0 },
    hourlyIncome: 0 // dividends + rentals
  },

  // Businesses
  businesses: [
    { name: "Apollo Fuels", type: "Oil & Gas Company", level: 2, basePerHour: 26503935.55 },
    { name: "SteelStream Factory", type: "Factory", level: 18, basePerHour: 55585.13 },
    { name: "RoadRunner Logistics", type: "Shipping Company", level: 265, basePerHour: 1200000 }
  ],
  bizMergeMultiplier: 1.00,

  // Items / Upgrades
  items: { garage: 0, hangar: 0, harbor: 0, residenceValue: 262400000, collectionsValue: 24000000 }
};

let state = loadState();

/* ======= Utils ======= */
const fmt = (n) => n.toLocaleString(undefined, { style: 'currency', currency: 'USD', maximumFractionDigits: 2 });
const pct = (n) => (n*100).toFixed(0) + "%";
const clamp = (v, min, max) => Math.min(Math.max(v, min), max);

function netHourlyIncome(){
  // Base business income
  const bizGross = state.businesses.reduce((s,b)=> s + b.basePerHour * (1 + (b.level*0.005)), 0) * state.bizMergeMultiplier;
  // Investing income: dividends + rentals from estate purchases
  const adndDiv = state.investing.shares.ADND * 0.0532 / (365*24); // 5.32% annual -> hourly
  const spDiv   = state.investing.shares.SP   * 0.0200 / (365*24); // 2% annual
  const aptRent = state.investing.estate.apartment * 2500;
  const vilRent = state.investing.estate.villa     * 25000;
  const investGross = adndDiv + spDiv + aptRent + vilRent;

  // Items affecting passive
  const passiveBoost = 1 + state.items.hangar*0.03 + state.items.harbor*0.02;
  let gross = (bizGross + investGross) * passiveBoost;

  // Holiday bonus
  if(state.bonusActive) gross *= (1 + state.holidayBonus);

  // Taxes on passive income only
  const net = gross * (1 - state.taxRate);
  state.investing.hourlyIncome = net; // store for display

  return { bizGross, investGross, gross, net };
}

function totalFortune(){
  const { net } = netHourlyIncome(); // computed
  const stocksVal = state.investing.shares.ADND + state.investing.shares.SP;
  const estateVal = state.investing.estate.apartment*1200000 + state.investing.estate.villa*12000000;
  const cryptoVal = state.investing.crypto.BTC + state.investing.crypto.ETH;
  const transportVal = (state.items.garage*1500000) + (state.items.hangar*2000000) + (state.items.harbor*1000000);
  return {
    balance: state.balance,
    businesses: state.businesses.reduce((s,b)=> s + b.basePerHour*500, 0), // notional valuation ~ 500x hourly
    stocks: stocksVal,
    estate: estateVal,
    transport: transportVal,
    collections: state.items.collectionsValue,
