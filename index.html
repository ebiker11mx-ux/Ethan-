// forest99.cpp
#include <bits/stdc++.h>
using namespace std;

struct Stats {
    int Health = 100;
        int Hunger = 0;
            int Energy = 100;
                int Wood = 0;
                    int Food = 0;
                        int Shelter = 0;
                            int Traps = 0;
                                int Night = 0;
                                };

                                static mt19937 rng([]{
                                    std::random_device rd;
                                        return mt19937(rd() ^ (unsigned)chrono::high_resolution_clock::now().time_since_epoch().count());
                                        }());

                                        int randInt(int a, int b) {
                                            uniform_int_distribution<int> d(a, b);
                                                return d(rng);
                                                }
                                                double rand01() {
                                                    uniform_real_distribution<double> d(0.0, 1.0);
                                                        return d(rng);
                                                        }

                                                        namespace StatsUtil {
                                                            void Clamp(Stats& s) {
                                                                    s.Health = max(0, min(100, s.Health));
                                                                            s.Hunger = max(0, min(100, s.Hunger));
                                                                                    s.Energy = max(0, min(100, s.Energy));
                                                                                            s.Shelter = max(0, s.Shelter);
                                                                                                }
                                                                                                }

                                                                                                namespace Actions {
                                                                                                    pair<bool,string> GatherWood(Stats& s) {
                                                                                                            if (s.Energy < 15) return {false, "Too tired."};
                                                                                                                    s.Energy -= 15;
                                                                                                                            int w = randInt(3,7);
                                                                                                                                    s.Wood += w;
                                                                                                                                            return {true, "Gathered " + to_string(w) + " wood."};
                                                                                                                                                }
                                                                                                                                                    pair<bool,string> Forage(Stats& s) {
                                                                                                                                                            if (s.Energy < 20) return {false, "Too tired."};
                                                                                                                                                                    s.Energy -= 20;
                                                                                                                                                                            int f = randInt(1,4);
                                                                                                                                                                                    int thorn = randInt(0,5);
                                                                                                                                                                                            s.Food += f;
                                                                                                                                                                                                    s.Health -= thorn;
                                                                                                                                                                                                            return {true, "Found " + to_string(f) + " food. Thorns (-" + to_string(thorn) + " health)."};
                                                                                                                                                                                                                }
                                                                                                                                                                                                                    pair<bool,string> Rest(Stats& s) {
                                                                                                                                                                                                                            int gain = randInt(20,35);
                                                                                                                                                                                                                                    s.Energy += gain;
                                                                                                                                                                                                                                            s.Hunger += 5;
                                                                                                                                                                                                                                                    return {true, "Rested, +" + to_string(gain) + " energy. Hunger +5."};
                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                            pair<bool,string> Cook(Stats& s) {
                                                                                                                                                                                                                                                                    if (s.Energy < 10) return {false, "Too tired."};
                                                                                                                                                                                                                                                                            if (s.Food <= 0) return {false, "No food to cook."};
                                                                                                                                                                                                                                                                                    s.Energy -= 10;
                                                                                                                                                                                                                                                                                            int cookQty = min(s.Food, 3);
                                                                                                                                                                                                                                                                                                    s.Food -= cookQty;
                                                                                                                                                                                                                                                                                                            s.Food += cookQty * 2; // cooked food counts double (simple buff)
                                                                                                                                                                                                                                                                                                                    return {true, "Cooked " + to_string(cookQty) + " food (counts double at night)."};
                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                            pair<bool,string> CraftShelter(Stats& s) {
                                                                                                                                                                                                                                                                                                                                    if (s.Energy < 25) return {false, "Too tired."};
                                                                                                                                                                                                                                                                                                                                            if (s.Wood < 6) return {false, "Need 6 wood."};
                                                                                                                                                                                                                                                                                                                                                    if (s.Shelter >= 10) return {false, "Shelter maxed."};
                                                                                                                                                                                                                                                                                                                                                            s.Energy -= 25;
                                                                                                                                                                                                                                                                                                                                                                    s.Wood -= 6;
                                                                                                                                                                                                                                                                                                                                                                            s.Shelter += 1;
                                                                                                                                                                                                                                                                                                                                                                                    return {true, "Shelter reinforced. Now " + to_string(s.Shelter) + "."};
                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                            pair<bool,string> SetTrap(Stats& s) {
                                                                                                                                                                                                                                                                                                                                                                                                    if (s.Energy < 10) return {false, "Too tired."};
                                                                                                                                                                                                                                                                                                                                                                                                            if (s.Wood < 2) return {false, "Need 2 wood."};
                                                                                                                                                                                                                                                                                                                                                                                                                    s.Energy -= 10;
                                                                                                                                                                                                                                                                                                                                                                                                                            s.Wood -= 2;
                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Traps += 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                            return {true, "Trap set. Total " + to_string(s.Traps) + "."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                    pair<bool,string> EatNow(Stats& s) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (s.Energy < 5) return {false, "Too tired."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (s.Food <= 0) return {false, "No food."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Energy -= 5;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Food -= 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Hunger = max(0, s.Hunger - 20);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    return {true, "Ate a meal. Hunger -20."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            pair<bool,string> Scout(Stats& s) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (s.Energy < 10) return {false, "Too tired."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Energy -= 10;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    double chance = 0.25 + randInt(0,10) / 100.0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (rand01() < chance) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        int w = randInt(2,5);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    int f = randInt(1,3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s.Wood += w; s.Food += f;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            return {true, "Cache found! +" + to_string(w) + " wood, +" + to_string(f) + " food."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int scratch = randInt(0,3);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Health -= scratch;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        return {true, "Nothing found. Scrape (-" + to_string(scratch) + " health)."};
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pair<bool,string> Skip(Stats&) { return {true, "Saving energy for night."}; }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        namespace Night {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            void Resolve(Stats& s) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Night += 1;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Baseline
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Hunger += 10;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Energy -= 10;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Traps
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (s.Traps > 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        int caught = 0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    for (int i=0;i<s.Traps;i++) if (rand01() < 0.35) caught++;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                s.Food += caught;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (caught > 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cout << "Your traps caught " << caught << " food.\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Auto-eat if hungry
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (s.Hunger >= 60 && s.Food > 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            int meals = min(2, s.Food);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        s.Food -= meals;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Hunger = max(0, s.Hunger - meals * 25);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cout << "You ate " << meals << " meal(s) to stave off hunger.\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Weather: cold night
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        bool cold = randInt(0,1) == 1;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (cold) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            int coldDmg = max(0, 8 - s.Shelter);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        s.Health -= coldDmg;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "A cold wind howls (-" << coldDmg << " health).\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Wolves
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            double wolfBase = 0.10 + (s.Night * 0.005);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (rand01() < wolfBase) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                int dmg = max(2, 18 - (s.Shelter * 2));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Health -= dmg;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "Wolves circle your camp! (-" << dmg << " health)\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    if (s.Wood >= 2) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Wood -= 2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "You burn extra wood to deter them (-2 wood).\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Starvation / fatigue
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (s.Hunger >= 90) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    s.Health -= 8;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cout << "Starvation gnaws at you (-8 health).\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (s.Energy <= 10) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            s.Health -= 5;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "Exhaustion sets in (-5 health).\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    struct Game {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Stats s;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            int actionsLeft = 2; // day actions per day
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                string phase = "Day"; // "Day" or "Night"
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                };

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void renderHUD(const Stats& s) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "\n=== Forest 99 ===\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "Night: " << s.Night << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cout << "Health: " << s.Health << " | Hunger: " << s.Hunger << " | Energy: " << s.Energy << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cout << "Wood: " << s.Wood << " | Food: " << s.Food << " | Shelter: " << s.Shelter << " | Traps: " << s.Traps << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                void renderActions(int actionsLeft) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "\nActions left: " << actionsLeft << "\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "1) GatherWood\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cout << "2) Forage\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cout << "3) Rest\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "4) Cook\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "5) CraftShelter\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cout << "6) SetTrap\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                cout << "7) EatNow\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    cout << "8) Scout\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        cout << "9) Skip\n";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            cout << "Choose: ";
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            bool handleAction